<mxfile host="app.diagrams.net" modified="2021-08-04T04:28:18.591Z" agent="5.0 (Macintosh; Intel Mac OS X 10_15_5) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/92.0.4515.107 Safari/537.36 Edg/92.0.902.62" etag="TlCcFsbo2NXq1qaqw8D_" version="14.9.3" type="github" pages="8">
  <diagram id="6dGlSP9AypZYp_pEiEp7" name="main">
    <mxGraphModel dx="1678" dy="844" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="s9HsxSQicOcgyOAXFe9G-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="Fzy5GeJwQQCdyaJ2enVI-2" target="Fzy5GeJwQQCdyaJ2enVI-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <UserObject label="stop-service-sk&lt;br&gt;(雲jenkins)" link="data:page/id,EZ-yJVy-s2bzyPia2vCW" id="Fzy5GeJwQQCdyaJ2enVI-2">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="354" y="70" width="120" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="s9HsxSQicOcgyOAXFe9G-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="Fzy5GeJwQQCdyaJ2enVI-3" target="s9HsxSQicOcgyOAXFe9G-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <UserObject label="release_sk_sk_cloud&lt;br&gt;(地jenkins)" link="data:page/id,JWTyyYmIpVCMN1m0Oudq" id="Fzy5GeJwQQCdyaJ2enVI-3">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="351" y="210" width="126" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="uifxp_jERDS7_eCDn6zP-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="Fzy5GeJwQQCdyaJ2enVI-4" target="s9HsxSQicOcgyOAXFe9G-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <UserObject label="RELEASE_sk&lt;br&gt;(雲jenkins)" link="data:page/id,q3yEjAj2njIeMwjzaU3D" id="Fzy5GeJwQQCdyaJ2enVI-4">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="234" y="470" width="120" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="uifxp_jERDS7_eCDn6zP-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="Fzy5GeJwQQCdyaJ2enVI-6" target="s9HsxSQicOcgyOAXFe9G-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Fzy5GeJwQQCdyaJ2enVI-6" value="gitlab-cicd&lt;br&gt;(雲gitlab)" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="474" y="470" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="s9HsxSQicOcgyOAXFe9G-1" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="s9HsxSQicOcgyOAXFe9G-3" target="s9HsxSQicOcgyOAXFe9G-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s9HsxSQicOcgyOAXFe9G-2" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="s9HsxSQicOcgyOAXFe9G-3" target="s9HsxSQicOcgyOAXFe9G-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <UserObject label="start-service-sk&lt;br&gt;(雲jenkins)" link="data:page/id,J1LoCyNlEwkDLII9hHWb" id="s9HsxSQicOcgyOAXFe9G-3">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="354" y="650" width="120" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;語法執行帳號變更密碼&lt;/p&gt;" link="data:page/id,8mKEFK1XjTl2QGOo6pQU" id="s9HsxSQicOcgyOAXFe9G-4">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="234" y="760" width="120" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <UserObject label="check-maintain-status-sk-Cq(雲jenkins)" link="data:page/id,6wDx5cMaMRj-ptNJoFFo" id="s9HsxSQicOcgyOAXFe9G-5">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="474" y="760" width="126" height="60" as="geometry" />
          </mxCell>
        </UserObject>
        <mxCell id="s9HsxSQicOcgyOAXFe9G-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="s9HsxSQicOcgyOAXFe9G-7" target="Fzy5GeJwQQCdyaJ2enVI-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="s9HsxSQicOcgyOAXFe9G-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="s9HsxSQicOcgyOAXFe9G-7" target="Fzy5GeJwQQCdyaJ2enVI-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <UserObject label="execute_maintain_job_sk&lt;br&gt;(雲jenkins)" link="data:page/id,TqfX8G7iaFCn8JOZhXEi" id="s9HsxSQicOcgyOAXFe9G-7">
          <mxCell style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
            <mxGeometry x="336" y="320" width="156" height="60" as="geometry" />
          </mxCell>
        </UserObject>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="EZ-yJVy-s2bzyPia2vCW" name="stop-service-sk">
    <mxGraphModel dx="1426" dy="717" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="7Fa5BVDuI3mbv9IQ5VK1-0" />
        <mxCell id="7Fa5BVDuI3mbv9IQ5VK1-1" parent="7Fa5BVDuI3mbv9IQ5VK1-0" />
        <mxCell id="l41_1opQb7HLKIFZmyiq-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="7Fa5BVDuI3mbv9IQ5VK1-1" source="l41_1opQb7HLKIFZmyiq-0" target="l41_1opQb7HLKIFZmyiq-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="l41_1opQb7HLKIFZmyiq-0" value="關閉備用外網ip流入" style="rounded=1;whiteSpace=wrap;html=1;" parent="7Fa5BVDuI3mbv9IQ5VK1-1" vertex="1">
          <mxGeometry x="200" y="80" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="l41_1opQb7HLKIFZmyiq-2" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;只允許&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;pineapple&lt;/span&gt;站&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;OTP&lt;/span&gt;以及正式站客服系統外網&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;ip&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;備用外網ip(103.252.156.13)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;流向：172.26.54.46,172.26.54.47(客服系統對外機)-&amp;gt;172.26.157.123(F5)&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;-&amp;gt;103.252.156.13(備用外網ip)&lt;/span&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="7Fa5BVDuI3mbv9IQ5VK1-1" vertex="1">
          <mxGeometry x="360" y="55" width="400" height="110" as="geometry" />
        </mxCell>
        <mxCell id="l41_1opQb7HLKIFZmyiq-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="7Fa5BVDuI3mbv9IQ5VK1-1" source="l41_1opQb7HLKIFZmyiq-3" target="l41_1opQb7HLKIFZmyiq-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="l41_1opQb7HLKIFZmyiq-3" value="stop sk service" style="rounded=1;whiteSpace=wrap;html=1;" parent="7Fa5BVDuI3mbv9IQ5VK1-1" vertex="1">
          <mxGeometry x="200" y="220" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="l41_1opQb7HLKIFZmyiq-4" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;透過&lt;/span&gt;kubectl apply haprox-stop-config&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;添加&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;whitelist-source-range: &quot;127.0.0.1&quot;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;，只允許本機的連線&lt;/span&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="7Fa5BVDuI3mbv9IQ5VK1-1" vertex="1">
          <mxGeometry x="365" y="210" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="l41_1opQb7HLKIFZmyiq-11" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="7Fa5BVDuI3mbv9IQ5VK1-1" source="l41_1opQb7HLKIFZmyiq-5" target="l41_1opQb7HLKIFZmyiq-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="l41_1opQb7HLKIFZmyiq-5" value="停durian-bg 背景" style="rounded=1;whiteSpace=wrap;html=1;" parent="7Fa5BVDuI3mbv9IQ5VK1-1" vertex="1">
          <mxGeometry x="200" y="360" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="l41_1opQb7HLKIFZmyiq-6" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;ssh&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;進去&lt;/span&gt;durian&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;背景機並跑&lt;/span&gt;bg_stop&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;bg_stop&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;：先確認&lt;/span&gt;user&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;是否為&lt;/span&gt;durian&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;，&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;接著將&lt;/span&gt;_run_bg&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;以及&lt;/span&gt;_run_immediate_message&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;這兩個進程&lt;/span&gt;kill&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;掉&lt;/span&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="7Fa5BVDuI3mbv9IQ5VK1-1" vertex="1">
          <mxGeometry x="365" y="350" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="l41_1opQb7HLKIFZmyiq-7" value="crontab 停止" style="rounded=1;whiteSpace=wrap;html=1;" parent="7Fa5BVDuI3mbv9IQ5VK1-1" vertex="1">
          <mxGeometry x="200" y="500" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="l41_1opQb7HLKIFZmyiq-8" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;備份crontab並且清除crontab。&lt;span class=&quot;Apple-converted-space&quot;&gt;&amp;nbsp; &amp;nbsp;&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;crontab -l &amp;gt; crontab-$date：顯示目前crontab 並且輸出成檔案並加上時間戳備份起來&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;crontab -r&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;：清除&lt;/span&gt;crontab&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="7Fa5BVDuI3mbv9IQ5VK1-1" vertex="1">
          <mxGeometry x="365" y="490" width="390" height="80" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="JWTyyYmIpVCMN1m0Oudq" name="release_sk_sk_cloud">
    <mxGraphModel dx="1426" dy="717" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="NqsLETtFn68mSmPujmHx-0" />
        <mxCell id="NqsLETtFn68mSmPujmHx-1" parent="NqsLETtFn68mSmPujmHx-0" />
        <mxCell id="x_HE3sd3-_n7QP_UE8BS-0" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="NqsLETtFn68mSmPujmHx-1" source="x_HE3sd3-_n7QP_UE8BS-1" target="x_HE3sd3-_n7QP_UE8BS-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x_HE3sd3-_n7QP_UE8BS-1" value="變更遠端倉庫地址" style="rounded=1;whiteSpace=wrap;html=1;" parent="NqsLETtFn68mSmPujmHx-1" vertex="1">
          <mxGeometry x="200" y="80" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="x_HE3sd3-_n7QP_UE8BS-2" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;進到/var/lib/jenkins/RELEASE_sk_sk_cloud/workspace&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;透過git remote set-url變更遠端倉庫地址&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="NqsLETtFn68mSmPujmHx-1" vertex="1">
          <mxGeometry x="360" y="55" width="400" height="110" as="geometry" />
        </mxCell>
        <mxCell id="x_HE3sd3-_n7QP_UE8BS-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="NqsLETtFn68mSmPujmHx-1" source="x_HE3sd3-_n7QP_UE8BS-4" target="x_HE3sd3-_n7QP_UE8BS-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x_HE3sd3-_n7QP_UE8BS-4" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;將&lt;/span&gt;release_sk&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;分支刪掉並重新創建&lt;/span&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="NqsLETtFn68mSmPujmHx-1" vertex="1">
          <mxGeometry x="200" y="220" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="x_HE3sd3-_n7QP_UE8BS-5" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;待補充&lt;/font&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="NqsLETtFn68mSmPujmHx-1" vertex="1">
          <mxGeometry x="365" y="210" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="x_HE3sd3-_n7QP_UE8BS-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="NqsLETtFn68mSmPujmHx-1" source="x_HE3sd3-_n7QP_UE8BS-7" target="x_HE3sd3-_n7QP_UE8BS-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x_HE3sd3-_n7QP_UE8BS-7" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;export&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;對外&lt;/span&gt;ip&lt;i&gt; 10.249.52.1&lt;/i&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="NqsLETtFn68mSmPujmHx-1" vertex="1">
          <mxGeometry x="200" y="360" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="x_HE3sd3-_n7QP_UE8BS-8" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;[跳板機&lt;/span&gt;&lt;i&gt; ipl-border.rd5.prod&lt;/i&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;]&lt;/span&gt;&lt;i&gt; 10.249.52.1 (otp)&lt;/i&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="NqsLETtFn68mSmPujmHx-1" vertex="1">
          <mxGeometry x="365" y="350" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="x_HE3sd3-_n7QP_UE8BS-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="NqsLETtFn68mSmPujmHx-1" source="x_HE3sd3-_n7QP_UE8BS-9" target="x_HE3sd3-_n7QP_UE8BS-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="x_HE3sd3-_n7QP_UE8BS-9" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;將地端&lt;/span&gt;gitlab&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;程式推上雲端&lt;/span&gt;gitlab&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="NqsLETtFn68mSmPujmHx-1" vertex="1">
          <mxGeometry x="200" y="500" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="x_HE3sd3-_n7QP_UE8BS-11" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;透過&lt;/span&gt;&lt;i&gt;gitlab&lt;/i&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;的&lt;/span&gt;&lt;i&gt;api&lt;/i&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;取得&lt;/span&gt;&lt;i&gt;pipeline&lt;/i&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;的&lt;/span&gt;&lt;i&gt;cicd status &lt;/i&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;判斷是否&lt;/span&gt;&lt;i&gt;status = success&lt;/i&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="NqsLETtFn68mSmPujmHx-1" vertex="1">
          <mxGeometry x="192.5" y="640" width="135" height="80" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="q3yEjAj2njIeMwjzaU3D" name="RELEASE_sk">
    <mxGraphModel dx="1426" dy="717" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="DliIWoVDqq9hmBoGjNYp-0" />
        <mxCell id="DliIWoVDqq9hmBoGjNYp-1" parent="DliIWoVDqq9hmBoGjNYp-0" />
        <mxCell id="0j0corsX04SEicpSa_xj-0" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;先拉程式到跳板機&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;(jenkins)&lt;/span&gt;，接著送程式到小球正式站背景機&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="DliIWoVDqq9hmBoGjNYp-1" vertex="1">
          <mxGeometry x="314" y="30" width="200" height="70" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-1" value="大綱" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="DliIWoVDqq9hmBoGjNYp-1" vertex="1">
          <mxGeometry x="180" y="32.5" width="100" height="65" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="DliIWoVDqq9hmBoGjNYp-1" source="0j0corsX04SEicpSa_xj-3" target="0j0corsX04SEicpSa_xj-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-3" value="透過cat shyaml篩選出小球背景的ip並放到skIp" style="rounded=1;whiteSpace=wrap;html=1;" parent="DliIWoVDqq9hmBoGjNYp-1" vertex="1">
          <mxGeometry x="328.5" y="300" width="170" height="100" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="DliIWoVDqq9hmBoGjNYp-1" source="0j0corsX04SEicpSa_xj-4" target="0j0corsX04SEicpSa_xj-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-4" value="從jenkins家目錄讀取fab/ipyml並放到ipListFile" style="rounded=1;whiteSpace=wrap;html=1;" parent="DliIWoVDqq9hmBoGjNYp-1" vertex="1">
          <mxGeometry x="353.5" y="190" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="DliIWoVDqq9hmBoGjNYp-1" source="0j0corsX04SEicpSa_xj-5" target="0j0corsX04SEicpSa_xj-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-5" value="設定branch=&#39;release_sk&#39;" style="rounded=1;whiteSpace=wrap;html=1;" parent="DliIWoVDqq9hmBoGjNYp-1" vertex="1">
          <mxGeometry x="333.5" y="440" width="160" height="90" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-15" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="DliIWoVDqq9hmBoGjNYp-1" source="0j0corsX04SEicpSa_xj-6" target="0j0corsX04SEicpSa_xj-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-6" value="透過fab pull:target=sk_staging,branch=&#39;release_sk&#39;&lt;br&gt;拉程式到跳板機(jenkins)" style="rounded=1;whiteSpace=wrap;html=1;" parent="DliIWoVDqq9hmBoGjNYp-1" vertex="1">
          <mxGeometry x="296" y="570" width="235" height="110" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-16" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="DliIWoVDqq9hmBoGjNYp-1" source="0j0corsX04SEicpSa_xj-7" target="0j0corsX04SEicpSa_xj-8" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-7" value="透過fab -H 127.0.0.1 switch:target=sk_staging&lt;br&gt;更新跳板機(jenkins)的軟連結" style="rounded=1;whiteSpace=wrap;html=1;" parent="DliIWoVDqq9hmBoGjNYp-1" vertex="1">
          <mxGeometry x="296" y="720" width="235" height="110" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-17" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="DliIWoVDqq9hmBoGjNYp-1" source="0j0corsX04SEicpSa_xj-8" target="0j0corsX04SEicpSa_xj-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-8" value="透過fab -H sk_background rsync:target=sk_prod&lt;br&gt;從跳板機(jenkins)送程式到小球背景機" style="rounded=1;whiteSpace=wrap;html=1;" parent="DliIWoVDqq9hmBoGjNYp-1" vertex="1">
          <mxGeometry x="296" y="880" width="235" height="110" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-20" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="DliIWoVDqq9hmBoGjNYp-1" source="0j0corsX04SEicpSa_xj-9" target="0j0corsX04SEicpSa_xj-10" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-9" value="透過fab -H sk_background switch:target=sk_prod&lt;br&gt;更新小球背景機的軟連結" style="rounded=1;whiteSpace=wrap;html=1;" parent="DliIWoVDqq9hmBoGjNYp-1" vertex="1">
          <mxGeometry x="296" y="1030" width="235" height="110" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-10" value="在小球背景幾執行migration" style="rounded=1;whiteSpace=wrap;html=1;" parent="DliIWoVDqq9hmBoGjNYp-1" vertex="1">
          <mxGeometry x="329" y="1190" width="170" height="100" as="geometry" />
        </mxCell>
        <mxCell id="0j0corsX04SEicpSa_xj-11" value="細部流程" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="DliIWoVDqq9hmBoGjNYp-1" vertex="1">
          <mxGeometry x="160" y="185" width="100" height="65" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="J1LoCyNlEwkDLII9hHWb" name="start-service-sk">
    <mxGraphModel dx="1426" dy="717" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="pho2_vS9bWqiX0k_2MXQ-0" />
        <mxCell id="pho2_vS9bWqiX0k_2MXQ-1" parent="pho2_vS9bWqiX0k_2MXQ-0" />
        <mxCell id="EtHQRPGvk6dfHRNMYTag-0" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="pho2_vS9bWqiX0k_2MXQ-1" source="EtHQRPGvk6dfHRNMYTag-1" target="EtHQRPGvk6dfHRNMYTag-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EtHQRPGvk6dfHRNMYTag-1" value="開啟 durian-bg 背景" style="rounded=1;whiteSpace=wrap;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="200" y="80" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="EtHQRPGvk6dfHRNMYTag-2" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;ssh&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;進去&lt;/span&gt;durian&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;背景機並跑&lt;/span&gt;bg_start&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;bg_start&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;：先確認&lt;/span&gt;user&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;是否為&lt;/span&gt;durian&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;，接著透過&lt;/span&gt;ps ax grep _run_bg&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;以及&lt;/span&gt;_run_immediate_message&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;是否啟動&lt;/span&gt;(&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;透過&lt;/span&gt;-z&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;判斷是否為空字串&lt;/span&gt;)&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;，最後透過&lt;/span&gt;nohub&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;持續將&lt;/span&gt;_run_bg&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;寫入到&lt;/span&gt;/home/durian/sk.durian/current/app/logs/bg.log&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;，&lt;/span&gt;&amp;amp;&amp;nbsp;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;把這個程式放在背景執行，持續將&lt;/span&gt;_run_immediate_message&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;寫入到&lt;/span&gt;/home/durian/sk.durian/current/app/logs/immediate_message.log&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="360" y="55" width="400" height="110" as="geometry" />
        </mxCell>
        <mxCell id="EtHQRPGvk6dfHRNMYTag-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="pho2_vS9bWqiX0k_2MXQ-1" source="EtHQRPGvk6dfHRNMYTag-4" target="EtHQRPGvk6dfHRNMYTag-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EtHQRPGvk6dfHRNMYTag-4" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;crontab 開啟&lt;/font&gt;&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="200" y="220" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="EtHQRPGvk6dfHRNMYTag-5" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;crontab -i crontab-$date&lt;br&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;指定crontab為停服務時所備份的版本並取代當前的crontab&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="365" y="210" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="EtHQRPGvk6dfHRNMYTag-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" source="EtHQRPGvk6dfHRNMYTag-7" target="EtHQRPGvk6dfHRNMYTag-9" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EtHQRPGvk6dfHRNMYTag-7" value="start sk service" style="rounded=1;whiteSpace=wrap;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="200" y="360" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="EtHQRPGvk6dfHRNMYTag-8" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;透過&lt;/span&gt;kubectl apply haprox-stop-config&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;將&lt;/span&gt;whitelist-source-range: &quot;127.0.0.1&quot;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;拿掉&lt;/span&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="365" y="350" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Jh25S6J5rf_fvRJ-1FiQ-4" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" source="EtHQRPGvk6dfHRNMYTag-9" target="Jh25S6J5rf_fvRJ-1FiQ-0" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="EtHQRPGvk6dfHRNMYTag-9" value="開放備用外網ip流量" style="rounded=1;whiteSpace=wrap;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="200" y="500" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="EtHQRPGvk6dfHRNMYTag-10" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;&lt;span style=&quot;font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;備用外網ip(103.252.156.13)&lt;/span&gt;&lt;br&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;流向：172.26.54.46,172.26.54.47-&amp;gt;172.26.157.123-&amp;gt;103.252.156.13&lt;/span&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="365" y="490" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Jh25S6J5rf_fvRJ-1FiQ-5" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" source="Jh25S6J5rf_fvRJ-1FiQ-0" target="Jh25S6J5rf_fvRJ-1FiQ-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Jh25S6J5rf_fvRJ-1FiQ-0" value="check durian ingress" style="rounded=1;whiteSpace=wrap;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="200" y="640" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Jh25S6J5rf_fvRJ-1FiQ-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" source="Jh25S6J5rf_fvRJ-1FiQ-1" target="Jh25S6J5rf_fvRJ-1FiQ-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Jh25S6J5rf_fvRJ-1FiQ-1" value="check session ingress" style="rounded=1;whiteSpace=wrap;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="200" y="760" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Jh25S6J5rf_fvRJ-1FiQ-7" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" source="Jh25S6J5rf_fvRJ-1FiQ-2" target="Jh25S6J5rf_fvRJ-1FiQ-3" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="Jh25S6J5rf_fvRJ-1FiQ-2" value="check blocker ingress" style="rounded=1;whiteSpace=wrap;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="200" y="880" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Jh25S6J5rf_fvRJ-1FiQ-3" value="check job queue ingress" style="rounded=1;whiteSpace=wrap;html=1;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="200" y="1000" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="Jh25S6J5rf_fvRJ-1FiQ-8" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;helvetica neue&quot;&gt;透過curl host:sk.durian.rd5呼叫雲端服務專線(10.5.18.22)&amp;nbsp; grep result:ok&amp;nbsp; health check 是否成功開啟服務&lt;/font&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="370" y="630" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Jh25S6J5rf_fvRJ-1FiQ-9" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;&lt;span style=&quot;font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;透過curl host:sk.durian.rd5呼叫雲端服務專線(10.5.18.22)&amp;nbsp; grep result:ok&amp;nbsp; health check 是否成功開啟服務&lt;/span&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="370" y="750" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Jh25S6J5rf_fvRJ-1FiQ-10" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;&lt;span style=&quot;font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;透過curl host:sk.durian.rd5呼叫雲端服務專線(10.5.18.22)&amp;nbsp; grep result:ok&amp;nbsp; health check 是否成功開啟服務&lt;/span&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="370" y="870" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="Jh25S6J5rf_fvRJ-1FiQ-11" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;helvetica neue&quot;&gt;透過curl host:sk.jq.pineapple呼叫雲端服務專線(10.5.18.22) grep kue health check 是否成功開啟服務(jq)&lt;/font&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="pho2_vS9bWqiX0k_2MXQ-1" vertex="1">
          <mxGeometry x="370" y="990" width="390" height="80" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="TqfX8G7iaFCn8JOZhXEi" name="execute_maintain_job_sk">
    <mxGraphModel dx="1426" dy="717" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="-Tlxtb1Jw4C08Klxp-Ff-0" />
        <mxCell id="-Tlxtb1Jw4C08Klxp-Ff-1" parent="-Tlxtb1Jw4C08Klxp-Ff-0" />
        <mxCell id="CFhKed-u82AaroHBtXeP-0" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="-Tlxtb1Jw4C08Klxp-Ff-1" source="CFhKed-u82AaroHBtXeP-1" target="CFhKed-u82AaroHBtXeP-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CFhKed-u82AaroHBtXeP-1" value="&lt;span style=&quot;color: rgb(51 , 51 , 51) ; font-family: , &amp;#34;blinkmacsystemfont&amp;#34; , &amp;#34;segoe ui&amp;#34; , &amp;#34;roboto&amp;#34; , &amp;#34;noto sans&amp;#34; , &amp;#34;oxygen&amp;#34; , &amp;#34;ubuntu&amp;#34; , &amp;#34;cantarell&amp;#34; , &amp;#34;fira sans&amp;#34; , &amp;#34;droid sans&amp;#34; , &amp;#34;helvetica neue&amp;#34; , &amp;#34;arial&amp;#34; , sans-serif , &amp;#34;apple color emoji&amp;#34; , &amp;#34;segoe ui emoji&amp;#34; , &amp;#34;segoe ui symbol&amp;#34; ; font-size: 14px ; background-color: rgb(255 , 255 , 255)&quot;&gt;clear-session-redis-sk&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="-Tlxtb1Jw4C08Klxp-Ff-1" vertex="1">
          <mxGeometry x="200" y="80" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="CFhKed-u82AaroHBtXeP-2" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;將三台&lt;/span&gt;redis-session-master flushdb&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;，&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;接著透過執行完flushdb的&lt;/span&gt;$?&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;是否為&lt;/span&gt;0&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;判斷是否成功，&lt;/span&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;最後進到&lt;/span&gt;durian-bg current&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;裡&lt;/span&gt; &lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;下&lt;/span&gt;create-session-info whitelist&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;以及&lt;/span&gt;maintain&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="-Tlxtb1Jw4C08Klxp-Ff-1" vertex="1">
          <mxGeometry x="360" y="55" width="400" height="110" as="geometry" />
        </mxCell>
        <mxCell id="CFhKed-u82AaroHBtXeP-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="-Tlxtb1Jw4C08Klxp-Ff-1" source="CFhKed-u82AaroHBtXeP-4" target="CFhKed-u82AaroHBtXeP-7" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="CFhKed-u82AaroHBtXeP-4" value="&lt;span style=&quot;color: rgb(51 , 51 , 51) ; font-family: , &amp;#34;blinkmacsystemfont&amp;#34; , &amp;#34;segoe ui&amp;#34; , &amp;#34;roboto&amp;#34; , &amp;#34;noto sans&amp;#34; , &amp;#34;oxygen&amp;#34; , &amp;#34;ubuntu&amp;#34; , &amp;#34;cantarell&amp;#34; , &amp;#34;fira sans&amp;#34; , &amp;#34;droid sans&amp;#34; , &amp;#34;helvetica neue&amp;#34; , &amp;#34;arial&amp;#34; , sans-serif , &amp;#34;apple color emoji&amp;#34; , &amp;#34;segoe ui emoji&amp;#34; , &amp;#34;segoe ui symbol&amp;#34; ; font-size: 14px ; background-color: rgb(255 , 255 , 255)&quot;&gt;clear-online-user-redis-sk&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="-Tlxtb1Jw4C08Klxp-Ff-1" vertex="1">
          <mxGeometry x="200" y="220" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="CFhKed-u82AaroHBtXeP-5" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;將三台&lt;/span&gt;onlineuser-cluster flushdb&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;，接著透過執行完flushdb的&lt;/span&gt;$?&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;是否為&lt;/span&gt;0&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;判斷是否成功&lt;/span&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="-Tlxtb1Jw4C08Klxp-Ff-1" vertex="1">
          <mxGeometry x="365" y="210" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="CFhKed-u82AaroHBtXeP-7" value="&lt;span style=&quot;color: rgb(51 , 51 , 51) ; font-family: , &amp;#34;blinkmacsystemfont&amp;#34; , &amp;#34;segoe ui&amp;#34; , &amp;#34;roboto&amp;#34; , &amp;#34;noto sans&amp;#34; , &amp;#34;oxygen&amp;#34; , &amp;#34;ubuntu&amp;#34; , &amp;#34;cantarell&amp;#34; , &amp;#34;fira sans&amp;#34; , &amp;#34;droid sans&amp;#34; , &amp;#34;helvetica neue&amp;#34; , &amp;#34;arial&amp;#34; , sans-serif , &amp;#34;apple color emoji&amp;#34; , &amp;#34;segoe ui emoji&amp;#34; , &amp;#34;segoe ui symbol&amp;#34; ; font-size: 14px ; background-color: rgb(255 , 255 , 255)&quot;&gt;delete-negative-sk&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="-Tlxtb1Jw4C08Klxp-Ff-1" vertex="1">
          <mxGeometry x="200" y="360" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="CFhKed-u82AaroHBtXeP-8" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;去&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;durian-bg&lt;/span&gt;的&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;current&lt;/span&gt;清除餘額已大於零的負數資料(-t cash-fake)&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;i&gt; &lt;/i&gt;&lt;/span&gt;每次最多&lt;span class=&quot;s1&quot; style=&quot;font-stretch: normal ; line-height: normal ; font-family: &amp;#34;helvetica neue&amp;#34;&quot;&gt;&lt;i&gt;100&lt;/i&gt;&lt;/span&gt;個使用者(-m 100)&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="-Tlxtb1Jw4C08Klxp-Ff-1" vertex="1">
          <mxGeometry x="365" y="350" width="390" height="80" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="8mKEFK1XjTl2QGOo6pQU" name="語法執行帳號變更密碼">
    <mxGraphModel dx="1426" dy="717" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="53Opt-Yo624oDXezcWb_-0" />
        <mxCell id="53Opt-Yo624oDXezcWb_-1" parent="53Opt-Yo624oDXezcWb_-0" />
        <mxCell id="NhyatYycq5qncItizdN6-0" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;維護完的檢查，檢查DRD有沒有改密碼，去durian-bg確認/home/durian/migrationssk.parameters.php資料庫密碼是否無法登入&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="53Opt-Yo624oDXezcWb_-1" vertex="1">
          <mxGeometry x="284" y="70" width="316" height="100" as="geometry" />
        </mxCell>
        <mxCell id="NhyatYycq5qncItizdN6-1" value="大綱" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="53Opt-Yo624oDXezcWb_-1" vertex="1">
          <mxGeometry x="150" y="87.5" width="100" height="65" as="geometry" />
        </mxCell>
        <mxCell id="NhyatYycq5qncItizdN6-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="53Opt-Yo624oDXezcWb_-1" source="NhyatYycq5qncItizdN6-2" target="NhyatYycq5qncItizdN6-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="NhyatYycq5qncItizdN6-2" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;sk.parameters.php裡面passwd要可以登入&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="53Opt-Yo624oDXezcWb_-1" vertex="1">
          <mxGeometry x="364" y="252.5" width="156" height="80" as="geometry" />
        </mxCell>
        <mxCell id="NhyatYycq5qncItizdN6-3" value="維護前(禮拜二)，改完密碼後" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="53Opt-Yo624oDXezcWb_-1" vertex="1">
          <mxGeometry x="230" y="267.5" width="100" height="65" as="geometry" />
        </mxCell>
        <mxCell id="NhyatYycq5qncItizdN6-4" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal ; font-family: &amp;#34;pingfang tc&amp;#34;&quot;&gt;DRD說已完成之後，確認資料庫密碼是否無法登入&lt;/p&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="53Opt-Yo624oDXezcWb_-1" vertex="1">
          <mxGeometry x="364" y="420" width="156" height="80" as="geometry" />
        </mxCell>
        <mxCell id="NhyatYycq5qncItizdN6-5" value="維護完(禮拜三)" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="53Opt-Yo624oDXezcWb_-1" vertex="1">
          <mxGeometry x="230" y="435" width="100" height="65" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="6wDx5cMaMRj-ptNJoFFo" name="check-maintain-status-sk-Cq">
    <mxGraphModel dx="1426" dy="717" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="3GW4WtEeVnlxcpDCJuAj-0" />
        <mxCell id="3GW4WtEeVnlxcpDCJuAj-1" parent="3GW4WtEeVnlxcpDCJuAj-0" />
        <mxCell id="dPMaIhJ7o6D1CmSOYTCu-0" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="3GW4WtEeVnlxcpDCJuAj-1" source="dPMaIhJ7o6D1CmSOYTCu-1" target="dPMaIhJ7o6D1CmSOYTCu-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dPMaIhJ7o6D1CmSOYTCu-1" value="&lt;font color=&quot;#333333&quot;&gt;&lt;span style=&quot;font-size: 14px&quot;&gt;haproxy ingress連web部分&lt;/span&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="3GW4WtEeVnlxcpDCJuAj-1" vertex="1">
          <mxGeometry x="200" y="80" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="dPMaIhJ7o6D1CmSOYTCu-2" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;透過curl -s -H &#39;host:sk.durian.rd5&#39; ip_haproxy_ingress/test|grep &#39;works&#39;&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;將篩選出的字串存到result，&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;接著透過if -n判斷result是否為非空字串，如果有work即代表成功&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;-s:silent mode 不會下載&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;-n:判斷是否為非空字串，空為false，非空為true&lt;/font&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="3GW4WtEeVnlxcpDCJuAj-1" vertex="1">
          <mxGeometry x="360" y="55" width="420" height="110" as="geometry" />
        </mxCell>
        <mxCell id="dPMaIhJ7o6D1CmSOYTCu-3" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="3GW4WtEeVnlxcpDCJuAj-1" source="dPMaIhJ7o6D1CmSOYTCu-4" target="dPMaIhJ7o6D1CmSOYTCu-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dPMaIhJ7o6D1CmSOYTCu-4" value="&lt;font color=&quot;#333333&quot;&gt;&lt;span style=&quot;font-size: 14px&quot;&gt;haproxy ingress連session部分&lt;/span&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="3GW4WtEeVnlxcpDCJuAj-1" vertex="1">
          <mxGeometry x="200" y="220" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="dPMaIhJ7o6D1CmSOYTCu-5" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;檢查F5連session機創建session的部分，有&#39;ok&#39;表示沒問題&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;先post建立一個user並grep result : ok | wc -l把計算結果放到created，&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;接著判斷是否成功建立，再來是get看看是否有這個user並判斷是否找得到，最後是做delete並判斷是否成功刪除。&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;&lt;br&gt;&lt;/font&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="3GW4WtEeVnlxcpDCJuAj-1" vertex="1">
          <mxGeometry x="365" y="210" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="dPMaIhJ7o6D1CmSOYTCu-6" value="&lt;font color=&quot;#333333&quot;&gt;&lt;span style=&quot;font-size: 14px&quot;&gt;haproxy ingress連blocker部分&lt;/span&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="3GW4WtEeVnlxcpDCJuAj-1" vertex="1">
          <mxGeometry x="200" y="360" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="dPMaIhJ7o6D1CmSOYTCu-7" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;透過curl -s -H &#39;host:sk.durian.rd5&#39; ip_haproxy_ingress/api/ip_blocker/check/ip|grep &#39;ok&#39; | wc -l&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;將篩選出的個數放到created&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;接著透過if -eq判斷created判斷是否為0，如果非0則echo ok&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" parent="3GW4WtEeVnlxcpDCJuAj-1" vertex="1">
          <mxGeometry x="365" y="350" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="dPMaIhJ7o6D1CmSOYTCu-9" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="3GW4WtEeVnlxcpDCJuAj-1" source="dPMaIhJ7o6D1CmSOYTCu-10" target="dPMaIhJ7o6D1CmSOYTCu-11" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="dPMaIhJ7o6D1CmSOYTCu-10" value="&lt;font color=&quot;#333333&quot;&gt;&lt;span style=&quot;font-size: 14px&quot;&gt;haproxy ingress 連 job queue 部分&lt;/span&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="3GW4WtEeVnlxcpDCJuAj-1" vertex="1">
          <mxGeometry x="200" y="500" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="dPMaIhJ7o6D1CmSOYTCu-11" value="&lt;font color=&quot;#333333&quot;&gt;&lt;span style=&quot;font-size: 14px&quot;&gt;對外連 admin 部分&lt;/span&gt;&lt;/font&gt;" style="rounded=1;whiteSpace=wrap;html=1;" parent="3GW4WtEeVnlxcpDCJuAj-1" vertex="1">
          <mxGeometry x="200" y="640" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="7nVRrst47D8DePquyWlI-0" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;透過curl -s -H &#39;host:admin.pineapple&#39; ha_ip/stats | grep &#39;completecount&#39; | wc -l&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;將篩選出的個數放到created&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;接著透過if -eq判斷created判斷是否為0，如果非0則echo ok&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="3GW4WtEeVnlxcpDCJuAj-1">
          <mxGeometry x="365" y="490" width="390" height="80" as="geometry" />
        </mxCell>
        <mxCell id="7nVRrst47D8DePquyWlI-1" value="&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;透過curl -s -H &#39;host:admin.pineapple&#39; ip_to_admin/api | grep &#39;ok&#39; | wc -l&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;將篩選出的個數放到created&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;font face=&quot;pingfang tc&quot;&gt;接著透過if -eq判斷created判斷是否為0，如果非0則echo ok&lt;/font&gt;&lt;/p&gt;&lt;p class=&quot;p1&quot; style=&quot;margin: 0px ; font-stretch: normal ; line-height: normal&quot;&gt;&lt;br&gt;&lt;/p&gt;" style="text;html=1;strokeColor=none;fillColor=none;align=center;verticalAlign=middle;whiteSpace=wrap;rounded=0;" vertex="1" parent="3GW4WtEeVnlxcpDCJuAj-1">
          <mxGeometry x="375" y="630" width="390" height="80" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
